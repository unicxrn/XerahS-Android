package com.xerahs.android.ui.theme

import androidx.compose.material3.ColorScheme
import androidx.compose.material3.darkColorScheme
import androidx.compose.material3.lightColorScheme
import androidx.compose.ui.graphics.Color
import com.xerahs.android.core.domain.model.ColorTheme

// Semantic colors
val Success = Color(0xFF4CAF50)
val OnSuccess = Color.White
val SuccessContainer = Color(0xFFC8E6C9)
val OnSuccessContainer = Color(0xFF002106)
val Warning = Color(0xFFFF9800)
val OnWarning = Color.White
val WarningContainer = Color(0xFFFFE0B2)
val OnWarningContainer = Color(0xFF311B00)

// Destination accent colors
val ImgurAccent = Color(0xFF1BB76E)
val S3Accent = Color(0xFFFF9900)
val FtpAccent = Color(0xFF2196F3)
val SftpAccent = Color(0xFF607D8B)

// --- Violet palette ---
private val VioletLightPrimary = Color(0xFF6B35E8)
private val VioletLightOnPrimary = Color.White
private val VioletLightPrimaryContainer = Color(0xFFE8DEFF)
private val VioletLightOnPrimaryContainer = Color(0xFF22005D)
private val VioletLightSecondary = Color(0xFF625B71)
private val VioletLightSecondaryContainer = Color(0xFFE8DEF8)
private val VioletLightTertiary = Color(0xFF7D5260)
private val VioletLightTertiaryContainer = Color(0xFFFFD8E4)
private val VioletLightBackground = Color(0xFFFFFBFE)
private val VioletLightSurface = Color(0xFFFFFBFE)
private val VioletLightSurfaceContainerLow = Color(0xFFF7F2FA)
private val VioletLightSurfaceContainer = Color(0xFFF1ECF4)

private val VioletDarkPrimary = Color(0xFFCFBCFF)
private val VioletDarkOnPrimary = Color(0xFF3A0093)
private val VioletDarkPrimaryContainer = Color(0xFF5B21B6)
private val VioletDarkOnPrimaryContainer = Color(0xFFE8DEFF)
private val VioletDarkSecondary = Color(0xFFCCC2DC)
private val VioletDarkSecondaryContainer = Color(0xFF4A4458)
private val VioletDarkTertiary = Color(0xFFEFB8C8)
private val VioletDarkTertiaryContainer = Color(0xFF633B48)
private val VioletDarkBackground = Color(0xFF1C1B1F)
private val VioletDarkSurface = Color(0xFF1C1B1F)
private val VioletDarkSurfaceContainerLow = Color(0xFF211F26)
private val VioletDarkSurfaceContainer = Color(0xFF2B2930)

// --- Teal palette ---
private val TealLightPrimary = Color(0xFF006A6A)
private val TealLightOnPrimary = Color.White
private val TealLightPrimaryContainer = Color(0xFF9CF1F0)
private val TealLightOnPrimaryContainer = Color(0xFF002020)
private val TealLightSecondary = Color(0xFF4A6363)
private val TealLightSecondaryContainer = Color(0xFFCCE8E7)
private val TealLightTertiary = Color(0xFF4B607C)
private val TealLightTertiaryContainer = Color(0xFFD3E3FF)
private val TealLightBackground = Color(0xFFFAFDFC)
private val TealLightSurface = Color(0xFFFAFDFC)
private val TealLightSurfaceContainerLow = Color(0xFFF1F5F4)
private val TealLightSurfaceContainer = Color(0xFFEBEFEE)

private val TealDarkPrimary = Color(0xFF80D5D4)
private val TealDarkOnPrimary = Color(0xFF003737)
private val TealDarkPrimaryContainer = Color(0xFF004F4F)
private val TealDarkOnPrimaryContainer = Color(0xFF9CF1F0)
private val TealDarkSecondary = Color(0xFFB0CCCB)
private val TealDarkSecondaryContainer = Color(0xFF334B4B)
private val TealDarkTertiary = Color(0xFFB3C8E8)
private val TealDarkTertiaryContainer = Color(0xFF334863)
private val TealDarkBackground = Color(0xFF191C1C)
private val TealDarkSurface = Color(0xFF191C1C)
private val TealDarkSurfaceContainerLow = Color(0xFF1F2222)
private val TealDarkSurfaceContainer = Color(0xFF272A2A)

// --- Blue palette ---
private val BlueLightPrimary = Color(0xFF0061A4)
private val BlueLightOnPrimary = Color.White
private val BlueLightPrimaryContainer = Color(0xFFD1E4FF)
private val BlueLightOnPrimaryContainer = Color(0xFF001D36)
private val BlueLightSecondary = Color(0xFF535F70)
private val BlueLightSecondaryContainer = Color(0xFFD7E3F7)
private val BlueLightTertiary = Color(0xFF6B5778)
private val BlueLightTertiaryContainer = Color(0xFFF2DAFF)
private val BlueLightBackground = Color(0xFFFDFCFF)
private val BlueLightSurface = Color(0xFFFDFCFF)
private val BlueLightSurfaceContainerLow = Color(0xFFF3F3F6)
private val BlueLightSurfaceContainer = Color(0xFFEDEDF0)

private val BlueDarkPrimary = Color(0xFF9ECAFF)
private val BlueDarkOnPrimary = Color(0xFF003258)
private val BlueDarkPrimaryContainer = Color(0xFF00497D)
private val BlueDarkOnPrimaryContainer = Color(0xFFD1E4FF)
private val BlueDarkSecondary = Color(0xFFBBC7DB)
private val BlueDarkSecondaryContainer = Color(0xFF3B4858)
private val BlueDarkTertiary = Color(0xFFD6BEE4)
private val BlueDarkTertiaryContainer = Color(0xFF533F5F)
private val BlueDarkBackground = Color(0xFF1A1C1E)
private val BlueDarkSurface = Color(0xFF1A1C1E)
private val BlueDarkSurfaceContainerLow = Color(0xFF202224)
private val BlueDarkSurfaceContainer = Color(0xFF28292C)

// --- Green palette ---
private val GreenLightPrimary = Color(0xFF386A20)
private val GreenLightOnPrimary = Color.White
private val GreenLightPrimaryContainer = Color(0xFFB7F397)
private val GreenLightOnPrimaryContainer = Color(0xFF062100)
private val GreenLightSecondary = Color(0xFF55624C)
private val GreenLightSecondaryContainer = Color(0xFFD9E7CB)
private val GreenLightTertiary = Color(0xFF386666)
private val GreenLightTertiaryContainer = Color(0xFFBBEBEB)
private val GreenLightBackground = Color(0xFFFDFDF5)
private val GreenLightSurface = Color(0xFFFDFDF5)
private val GreenLightSurfaceContainerLow = Color(0xFFF3F4EC)
private val GreenLightSurfaceContainer = Color(0xFFEDEEE6)

private val GreenDarkPrimary = Color(0xFF9CD67D)
private val GreenDarkOnPrimary = Color(0xFF0F3900)
private val GreenDarkPrimaryContainer = Color(0xFF205107)
private val GreenDarkOnPrimaryContainer = Color(0xFFB7F397)
private val GreenDarkSecondary = Color(0xFFBDCBB0)
private val GreenDarkSecondaryContainer = Color(0xFF3E4A36)
private val GreenDarkTertiary = Color(0xFFA0CFCF)
private val GreenDarkTertiaryContainer = Color(0xFF1F4E4E)
private val GreenDarkBackground = Color(0xFF1A1C18)
private val GreenDarkSurface = Color(0xFF1A1C18)
private val GreenDarkSurfaceContainerLow = Color(0xFF20221D)
private val GreenDarkSurfaceContainer = Color(0xFF282A24)

// --- Orange palette ---
private val OrangeLightPrimary = Color(0xFF8B5000)
private val OrangeLightOnPrimary = Color.White
private val OrangeLightPrimaryContainer = Color(0xFFFFDCBE)
private val OrangeLightOnPrimaryContainer = Color(0xFF2C1600)
private val OrangeLightSecondary = Color(0xFF735941)
private val OrangeLightSecondaryContainer = Color(0xFFFFDCBE)
private val OrangeLightTertiary = Color(0xFF586339)
private val OrangeLightTertiaryContainer = Color(0xFFDCE8B4)
private val OrangeLightBackground = Color(0xFFFFFBFF)
private val OrangeLightSurface = Color(0xFFFFFBFF)
private val OrangeLightSurfaceContainerLow = Color(0xFFF8F2EC)
private val OrangeLightSurfaceContainer = Color(0xFFF2ECE6)

private val OrangeDarkPrimary = Color(0xFFFFB870)
private val OrangeDarkOnPrimary = Color(0xFF4A2800)
private val OrangeDarkPrimaryContainer = Color(0xFF6A3C00)
private val OrangeDarkOnPrimaryContainer = Color(0xFFFFDCBE)
private val OrangeDarkSecondary = Color(0xFFDFC0A4)
private val OrangeDarkSecondaryContainer = Color(0xFF5A422C)
private val OrangeDarkTertiary = Color(0xFFC0CC9A)
private val OrangeDarkTertiaryContainer = Color(0xFF404B24)
private val OrangeDarkBackground = Color(0xFF1F1B16)
private val OrangeDarkSurface = Color(0xFF1F1B16)
private val OrangeDarkSurfaceContainerLow = Color(0xFF25211C)
private val OrangeDarkSurfaceContainer = Color(0xFF2D2923)

// --- Pink palette ---
private val PinkLightPrimary = Color(0xFF984061)
private val PinkLightOnPrimary = Color.White
private val PinkLightPrimaryContainer = Color(0xFFFFD9E2)
private val PinkLightOnPrimaryContainer = Color(0xFF3E001D)
private val PinkLightSecondary = Color(0xFF74565F)
private val PinkLightSecondaryContainer = Color(0xFFFFD9E2)
private val PinkLightTertiary = Color(0xFF7C5635)
private val PinkLightTertiaryContainer = Color(0xFFFFDCC1)
private val PinkLightBackground = Color(0xFFFFFBFF)
private val PinkLightSurface = Color(0xFFFFFBFF)
private val PinkLightSurfaceContainerLow = Color(0xFFF9F1F3)
private val PinkLightSurfaceContainer = Color(0xFFF3EBED)

private val PinkDarkPrimary = Color(0xFFFFB1C8)
private val PinkDarkOnPrimary = Color(0xFF5E1133)
private val PinkDarkPrimaryContainer = Color(0xFF7B2949)
private val PinkDarkOnPrimaryContainer = Color(0xFFFFD9E2)
private val PinkDarkSecondary = Color(0xFFE2BDC6)
private val PinkDarkSecondaryContainer = Color(0xFF5B3F47)
private val PinkDarkTertiary = Color(0xFFEFBD94)
private val PinkDarkTertiaryContainer = Color(0xFF623F20)
private val PinkDarkBackground = Color(0xFF201A1B)
private val PinkDarkSurface = Color(0xFF201A1B)
private val PinkDarkSurfaceContainerLow = Color(0xFF272022)
private val PinkDarkSurfaceContainer = Color(0xFF2F2829)

fun colorSchemeForTheme(colorTheme: ColorTheme, darkTheme: Boolean, oledBlack: Boolean = false): ColorScheme {
    return when (colorTheme) {
        ColorTheme.VIOLET -> if (darkTheme) darkColorScheme(
            primary = VioletDarkPrimary,
            onPrimary = VioletDarkOnPrimary,
            primaryContainer = VioletDarkPrimaryContainer,
            onPrimaryContainer = VioletDarkOnPrimaryContainer,
            secondary = VioletDarkSecondary,
            secondaryContainer = VioletDarkSecondaryContainer,
            tertiary = VioletDarkTertiary,
            tertiaryContainer = VioletDarkTertiaryContainer,
            background = VioletDarkBackground,
            surface = VioletDarkSurface,
            surfaceContainerLow = VioletDarkSurfaceContainerLow,
            surfaceContainer = VioletDarkSurfaceContainer,
        ) else lightColorScheme(
            primary = VioletLightPrimary,
            onPrimary = VioletLightOnPrimary,
            primaryContainer = VioletLightPrimaryContainer,
            onPrimaryContainer = VioletLightOnPrimaryContainer,
            secondary = VioletLightSecondary,
            secondaryContainer = VioletLightSecondaryContainer,
            tertiary = VioletLightTertiary,
            tertiaryContainer = VioletLightTertiaryContainer,
            background = VioletLightBackground,
            surface = VioletLightSurface,
            surfaceContainerLow = VioletLightSurfaceContainerLow,
            surfaceContainer = VioletLightSurfaceContainer,
        )
        ColorTheme.TEAL -> if (darkTheme) darkColorScheme(
            primary = TealDarkPrimary,
            onPrimary = TealDarkOnPrimary,
            primaryContainer = TealDarkPrimaryContainer,
            onPrimaryContainer = TealDarkOnPrimaryContainer,
            secondary = TealDarkSecondary,
            secondaryContainer = TealDarkSecondaryContainer,
            tertiary = TealDarkTertiary,
            tertiaryContainer = TealDarkTertiaryContainer,
            background = TealDarkBackground,
            surface = TealDarkSurface,
            surfaceContainerLow = TealDarkSurfaceContainerLow,
            surfaceContainer = TealDarkSurfaceContainer,
        ) else lightColorScheme(
            primary = TealLightPrimary,
            onPrimary = TealLightOnPrimary,
            primaryContainer = TealLightPrimaryContainer,
            onPrimaryContainer = TealLightOnPrimaryContainer,
            secondary = TealLightSecondary,
            secondaryContainer = TealLightSecondaryContainer,
            tertiary = TealLightTertiary,
            tertiaryContainer = TealLightTertiaryContainer,
            background = TealLightBackground,
            surface = TealLightSurface,
            surfaceContainerLow = TealLightSurfaceContainerLow,
            surfaceContainer = TealLightSurfaceContainer,
        )
        ColorTheme.BLUE -> if (darkTheme) darkColorScheme(
            primary = BlueDarkPrimary,
            onPrimary = BlueDarkOnPrimary,
            primaryContainer = BlueDarkPrimaryContainer,
            onPrimaryContainer = BlueDarkOnPrimaryContainer,
            secondary = BlueDarkSecondary,
            secondaryContainer = BlueDarkSecondaryContainer,
            tertiary = BlueDarkTertiary,
            tertiaryContainer = BlueDarkTertiaryContainer,
            background = BlueDarkBackground,
            surface = BlueDarkSurface,
            surfaceContainerLow = BlueDarkSurfaceContainerLow,
            surfaceContainer = BlueDarkSurfaceContainer,
        ) else lightColorScheme(
            primary = BlueLightPrimary,
            onPrimary = BlueLightOnPrimary,
            primaryContainer = BlueLightPrimaryContainer,
            onPrimaryContainer = BlueLightOnPrimaryContainer,
            secondary = BlueLightSecondary,
            secondaryContainer = BlueLightSecondaryContainer,
            tertiary = BlueLightTertiary,
            tertiaryContainer = BlueLightTertiaryContainer,
            background = BlueLightBackground,
            surface = BlueLightSurface,
            surfaceContainerLow = BlueLightSurfaceContainerLow,
            surfaceContainer = BlueLightSurfaceContainer,
        )
        ColorTheme.GREEN -> if (darkTheme) darkColorScheme(
            primary = GreenDarkPrimary,
            onPrimary = GreenDarkOnPrimary,
            primaryContainer = GreenDarkPrimaryContainer,
            onPrimaryContainer = GreenDarkOnPrimaryContainer,
            secondary = GreenDarkSecondary,
            secondaryContainer = GreenDarkSecondaryContainer,
            tertiary = GreenDarkTertiary,
            tertiaryContainer = GreenDarkTertiaryContainer,
            background = GreenDarkBackground,
            surface = GreenDarkSurface,
            surfaceContainerLow = GreenDarkSurfaceContainerLow,
            surfaceContainer = GreenDarkSurfaceContainer,
        ) else lightColorScheme(
            primary = GreenLightPrimary,
            onPrimary = GreenLightOnPrimary,
            primaryContainer = GreenLightPrimaryContainer,
            onPrimaryContainer = GreenLightOnPrimaryContainer,
            secondary = GreenLightSecondary,
            secondaryContainer = GreenLightSecondaryContainer,
            tertiary = GreenLightTertiary,
            tertiaryContainer = GreenLightTertiaryContainer,
            background = GreenLightBackground,
            surface = GreenLightSurface,
            surfaceContainerLow = GreenLightSurfaceContainerLow,
            surfaceContainer = GreenLightSurfaceContainer,
        )
        ColorTheme.ORANGE -> if (darkTheme) darkColorScheme(
            primary = OrangeDarkPrimary,
            onPrimary = OrangeDarkOnPrimary,
            primaryContainer = OrangeDarkPrimaryContainer,
            onPrimaryContainer = OrangeDarkOnPrimaryContainer,
            secondary = OrangeDarkSecondary,
            secondaryContainer = OrangeDarkSecondaryContainer,
            tertiary = OrangeDarkTertiary,
            tertiaryContainer = OrangeDarkTertiaryContainer,
            background = OrangeDarkBackground,
            surface = OrangeDarkSurface,
            surfaceContainerLow = OrangeDarkSurfaceContainerLow,
            surfaceContainer = OrangeDarkSurfaceContainer,
        ) else lightColorScheme(
            primary = OrangeLightPrimary,
            onPrimary = OrangeLightOnPrimary,
            primaryContainer = OrangeLightPrimaryContainer,
            onPrimaryContainer = OrangeLightOnPrimaryContainer,
            secondary = OrangeLightSecondary,
            secondaryContainer = OrangeLightSecondaryContainer,
            tertiary = OrangeLightTertiary,
            tertiaryContainer = OrangeLightTertiaryContainer,
            background = OrangeLightBackground,
            surface = OrangeLightSurface,
            surfaceContainerLow = OrangeLightSurfaceContainerLow,
            surfaceContainer = OrangeLightSurfaceContainer,
        )
        ColorTheme.PINK -> if (darkTheme) darkColorScheme(
            primary = PinkDarkPrimary,
            onPrimary = PinkDarkOnPrimary,
            primaryContainer = PinkDarkPrimaryContainer,
            onPrimaryContainer = PinkDarkOnPrimaryContainer,
            secondary = PinkDarkSecondary,
            secondaryContainer = PinkDarkSecondaryContainer,
            tertiary = PinkDarkTertiary,
            tertiaryContainer = PinkDarkTertiaryContainer,
            background = PinkDarkBackground,
            surface = PinkDarkSurface,
            surfaceContainerLow = PinkDarkSurfaceContainerLow,
            surfaceContainer = PinkDarkSurfaceContainer,
        ) else lightColorScheme(
            primary = PinkLightPrimary,
            onPrimary = PinkLightOnPrimary,
            primaryContainer = PinkLightPrimaryContainer,
            onPrimaryContainer = PinkLightOnPrimaryContainer,
            secondary = PinkLightSecondary,
            secondaryContainer = PinkLightSecondaryContainer,
            tertiary = PinkLightTertiary,
            tertiaryContainer = PinkLightTertiaryContainer,
            background = PinkLightBackground,
            surface = PinkLightSurface,
            surfaceContainerLow = PinkLightSurfaceContainerLow,
            surfaceContainer = PinkLightSurfaceContainer,
        )
    }.let { scheme ->
        if (oledBlack && darkTheme) {
            scheme.copy(
                background = Color.Black,
                surface = Color.Black,
                surfaceContainerLow = Color(0xFF050505),
                surfaceContainer = Color(0xFF0A0A0A),
                surfaceContainerHigh = Color(0xFF121212),
            )
        } else {
            scheme
        }
    }
}

/**
 * Generate a Material3-like ColorScheme from a single seed color using HSL derivation.
 */
fun generateColorSchemeFromSeed(seedColor: Int, darkTheme: Boolean, oledBlack: Boolean = false): ColorScheme {
    val hsl = floatArrayOf(0f, 0f, 0f)
    android.graphics.Color.colorToHSV(seedColor, hsl)
    val hue = hsl[0]
    val sat = hsl[1]

    fun hslColor(h: Float, s: Float, l: Float): Color {
        val clampH = ((h % 360f) + 360f) % 360f
        val clampS = s.coerceIn(0f, 1f)
        val clampL = l.coerceIn(0f, 1f)
        val c = (1f - kotlin.math.abs(2f * clampL - 1f)) * clampS
        val x = c * (1f - kotlin.math.abs((clampH / 60f) % 2f - 1f))
        val m = clampL - c / 2f
        val (r1, g1, b1) = when {
            clampH < 60f -> Triple(c, x, 0f)
            clampH < 120f -> Triple(x, c, 0f)
            clampH < 180f -> Triple(0f, c, x)
            clampH < 240f -> Triple(0f, x, c)
            clampH < 300f -> Triple(x, 0f, c)
            else -> Triple(c, 0f, x)
        }
        return Color(
            red = (r1 + m).coerceIn(0f, 1f),
            green = (g1 + m).coerceIn(0f, 1f),
            blue = (b1 + m).coerceIn(0f, 1f)
        )
    }

    val secondaryHue = hue + 30f
    val tertiaryHue = hue + 60f

    return if (darkTheme) {
        darkColorScheme(
            primary = hslColor(hue, sat * 0.6f, 0.75f),
            onPrimary = hslColor(hue, sat * 0.8f, 0.15f),
            primaryContainer = hslColor(hue, sat * 0.7f, 0.30f),
            onPrimaryContainer = hslColor(hue, sat * 0.4f, 0.90f),
            secondary = hslColor(secondaryHue, sat * 0.3f, 0.75f),
            secondaryContainer = hslColor(secondaryHue, sat * 0.3f, 0.30f),
            tertiary = hslColor(tertiaryHue, sat * 0.4f, 0.75f),
            tertiaryContainer = hslColor(tertiaryHue, sat * 0.4f, 0.30f),
            background = if (oledBlack) Color.Black else hslColor(hue, sat * 0.1f, 0.10f),
            surface = if (oledBlack) Color.Black else hslColor(hue, sat * 0.1f, 0.10f),
            surfaceContainerLow = if (oledBlack) Color(0xFF050505) else hslColor(hue, sat * 0.1f, 0.13f),
            surfaceContainer = if (oledBlack) Color(0xFF0A0A0A) else hslColor(hue, sat * 0.1f, 0.16f),
            surfaceContainerHigh = if (oledBlack) Color(0xFF121212) else hslColor(hue, sat * 0.1f, 0.20f),
        )
    } else {
        lightColorScheme(
            primary = hslColor(hue, sat * 0.8f, 0.40f),
            onPrimary = Color.White,
            primaryContainer = hslColor(hue, sat * 0.5f, 0.90f),
            onPrimaryContainer = hslColor(hue, sat * 0.8f, 0.15f),
            secondary = hslColor(secondaryHue, sat * 0.3f, 0.40f),
            secondaryContainer = hslColor(secondaryHue, sat * 0.3f, 0.90f),
            tertiary = hslColor(tertiaryHue, sat * 0.4f, 0.40f),
            tertiaryContainer = hslColor(tertiaryHue, sat * 0.3f, 0.90f),
            background = hslColor(hue, sat * 0.05f, 0.98f),
            surface = hslColor(hue, sat * 0.05f, 0.98f),
            surfaceContainerLow = hslColor(hue, sat * 0.05f, 0.96f),
            surfaceContainer = hslColor(hue, sat * 0.05f, 0.94f),
        )
    }
}

/** Representative primary color for each theme (used in theme picker swatches). */
fun ColorTheme.previewColor(): Color = when (this) {
    ColorTheme.VIOLET -> VioletLightPrimary
    ColorTheme.TEAL -> TealLightPrimary
    ColorTheme.BLUE -> BlueLightPrimary
    ColorTheme.GREEN -> GreenLightPrimary
    ColorTheme.ORANGE -> OrangeLightPrimary
    ColorTheme.PINK -> PinkLightPrimary
}
